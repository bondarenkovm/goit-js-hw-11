{"mappings":"qhBAAA,IAAAA,EAAAC,EAAA,S,aAMA,MAAMC,EAAgB,IAAI,E,WAAAC,SACpBC,EAAOC,SAASC,cAAc,gBAC9BC,EAAUF,SAASC,cAAc,YAEvC,IAAIE,EAAW,IAAIC,EAAAC,GAAJ,CAAmB,aAAc,CAC9CC,aAAc,MACdC,aAAc,MAGhB,MAKMC,EAAW,IAAIC,sBA0BrB,SAAwBC,GAEtBA,EAAQC,SAAQC,IACVA,EAAMC,gBACRhB,EACGiB,eACAC,MAAK,EAACC,KAAEA,EAAIC,UAAEA,MAOb,GANAC,EAAa,C,KAAEF,E,UAAMC,IAErBT,EAASW,QAAQjB,EAAQkB,kBAIrBlB,EAAQmB,SAASC,SAAWL,EAM9B,OAJAT,EAASe,kBACT5B,EAAA6B,OAAOC,QACL,6D,IAKLC,OAAMC,IACLnB,EAASe,aACT5B,EAAA6B,OAAOC,QACL,6DACD,GACD,G,GA1DM,CACdG,KAAM,KACNC,WAAY,QACZC,UAAW,IA4Db,SAASZ,GAAaF,KAAEA,EAAIC,UAAEA,IACA,IAAxBpB,EAAckC,OAChBpC,EAAA6B,OAAOQ,QAAQ,oBAAoBf,aAGrC,MAAMgB,EAASjB,EACZkB,KACC,EAACC,aACCA,EAAYC,cACZA,EAAaC,KACbA,EAAIC,MACJA,EAAKC,MACLA,EAAKC,SACLA,EAAQC,UACRA,KAEO,0EAEEL,6CACsBD,WAAsBE,+GAGhBC,qDACAC,wDACGC,yDACCC,oCAK5CC,KAAK,IACRxC,EAAQyC,mBAAmB,YAAaV,GAExCzB,EAASW,QAAQjB,EAAQkB,kBAEzBjB,EAASyC,UAQX,WACE,MAAQC,OAAQC,GACd5C,EAAQ6C,kBAAkBC,wBAC5BC,OAAOC,SAAS,CACdC,IAAkB,IAAbL,EACLM,SAAU,U,CAZZC,E,CAGF,SAASC,IACPpD,EAAQqD,UAAY,E,CAhGtBxD,EAAKyD,iBAAiB,UAEtB,SAAsBC,GACpBA,EAAIC,iBAEAD,EAAIE,cAAcC,SAASC,YAAYC,MAAMC,QAC/CT,IACAzD,EAAcmE,MAAQP,EAAIE,cAAcC,SAASC,YAAYC,MAAMC,OACnElE,EAAcoE,YACdpE,EAAciB,eAAeC,MAAK,EAACC,KAAEA,EAAIC,UAAEA,MACpCD,EAAKM,OAMVJ,EAAa,C,KAAEF,E,UAAMC,IALnBtB,EAAA6B,OAAOC,QACL,2EAI6B,MAGnC6B,IACA3D,EAAA6B,OAAOC,QAAQ,yB","sources":["src/js/infinite-scroll.js"],"sourcesContent":["import { Notify } from 'notiflix/build/notiflix-notify-aio';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport NewApiPixabay from './fetchPixabayAPI';\n\nconst newApiPixabay = new NewApiPixabay();\nconst form = document.querySelector('#search-form');\nconst gallery = document.querySelector('.gallery');\n\nvar lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: `alt`,\n  captionDelay: 250,\n});\n\nconst options = {\n  root: null,\n  rootMargin: '300px',\n  threshold: 1.0,\n};\nconst observer = new IntersectionObserver(onInfinityload, options);\n\nform.addEventListener('submit', onSubmitForm);\n\nfunction onSubmitForm(evt) {\n  evt.preventDefault();\n\n  if (evt.currentTarget.elements.searchQuery.value.trim()) {\n    clearGallery();\n    newApiPixabay.query = evt.currentTarget.elements.searchQuery.value.trim();\n    newApiPixabay.resetPage();\n    newApiPixabay.fetchPixabay().then(({ hits, totalHits }) => {\n      if (!hits.length) {\n        Notify.failure(\n          'Sorry, there are no images matching your search query. Please try again.'\n        );\n        return;\n      }\n      renderMarkup({ hits, totalHits });\n    });\n  } else {\n    clearGallery();\n    Notify.failure('Enter data to search!');\n  }\n}\n\nfunction onInfinityload(entries) {\n  //   console.log(entries);\n  entries.forEach(entry => {\n    if (entry.isIntersecting) {\n      newApiPixabay\n        .fetchPixabay()\n        .then(({ hits, totalHits }) => {\n          renderMarkup({ hits, totalHits });\n\n          observer.observe(gallery.lastElementChild);\n          //   console.log(gallery.children.length);\n          //   console.log(totalHits);\n\n          if (gallery.children.length === totalHits) {\n            // console.log(gallery.lastElementChild);\n            observer.disconnect();\n            Notify.failure(\n              \"We're sorry, but you've reached the end of search results.\"\n            );\n            return;\n          }\n        })\n        .catch(error => {\n          observer.disconnect();\n          Notify.failure(\n            \"We're sorry, but you've reached the end of search results.\"\n          );\n        });\n    }\n  });\n}\n\nfunction renderMarkup({ hits, totalHits }) {\n  if (newApiPixabay.pages === 2) {\n    Notify.success(`Hooray! We found ${totalHits} images.`);\n  }\n\n  const markup = hits\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<div class=\"photo-card\">\n        <div class=\"wraper\">\n      <a href=\"${largeImageURL}\">\n        <img class=\"card-image\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\"/>\n      </a></div>\n      <div class=\"info\">\n        <p class=\"info-item\"><b>Likes: </b>${likes}</p>\n        <p class=\"info-item\"><b>Views: </b>${views}</p>\n        <p class=\"info-item\"><b>Comments: </b>${comments}</p>\n        <p class=\"info-item\"><b>Downloads: </b>${downloads}</p>\n      </div>\n    </div>`;\n      }\n    )\n    .join('');\n  gallery.insertAdjacentHTML('beforeend', markup);\n\n  observer.observe(gallery.lastElementChild);\n\n  lightbox.refresh();\n  smoothScroll();\n}\n\nfunction clearGallery() {\n  gallery.innerHTML = '';\n}\n\nfunction smoothScroll() {\n  const { height: cardHeight } =\n    gallery.firstElementChild.getBoundingClientRect();\n  window.scrollBy({\n    top: cardHeight * 0.31,\n    behavior: 'smooth',\n  });\n}\n"],"names":["$iQIUW","parcelRequire","$7f13665ecc617d63$var$newApiPixabay","default","$7f13665ecc617d63$var$form","document","querySelector","$7f13665ecc617d63$var$gallery","$7f13665ecc617d63$var$lightbox","$parcel$interopDefault","$fZKcF","captionsData","captionDelay","$7f13665ecc617d63$var$observer","IntersectionObserver","entries","forEach","entry","isIntersecting","fetchPixabay","then","hits","totalHits","$7f13665ecc617d63$var$renderMarkup","observe","lastElementChild","children","length","disconnect","Notify","failure","catch","error","root","rootMargin","threshold","pages","success","markup","map","webformatURL","largeImageURL","tags","likes","views","comments","downloads","join","insertAdjacentHTML","refresh","height","cardHeight","firstElementChild","getBoundingClientRect","window","scrollBy","top","behavior","$7f13665ecc617d63$var$smoothScroll","$7f13665ecc617d63$var$clearGallery","innerHTML","addEventListener","evt","preventDefault","currentTarget","elements","searchQuery","value","trim","query","resetPage"],"version":3,"file":"infinite-scroll.8e492d6d.js.map"}